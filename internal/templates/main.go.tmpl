// Package {{ .SchemaPackageName }} provides primitives to interact with entities of a coda document.
//
// Code generated by github.com/artsafin/coda-schema-generator DO NOT EDIT.

package {{ .SchemaPackageName }}

import (
    "context"
    "encoding/json"
    "fmt"
    "github.com/artsafin/coda-go-client/{{ .APIPackageName }}"
    "net/http"
    "strconv"
    "strings"
	"sync"
    "time"
)

//region Basic types

type _schema struct {
	Table   _tableSchema
	Formula _formulaSchema
	Control _controlSchema
}

type _codaEntity struct {
	ID   string
	Name string
}

func (e _codaEntity) String() string {
	return e.ID
}

type _tableSchema struct {
    {{- range .Tables.Items }}
    {{fieldName .Name}} {{typeName .Name "Table"}} // {{ .Name }}
    {{- end }}
}
type _formulaSchema struct {
    {{- range .Formulas.Items }}
    {{fieldName .Name}} _codaEntity // {{ .Name }}
    {{- end }}
}
type _controlSchema struct {
    {{- range .Controls.Items }}
    {{fieldName .Name}} _codaEntity // {{ .Name }}
    {{- end }}
}

{{- range .Tables.Items }}

// Table {{ .Name }}
type {{typeName .Name "Table"}} struct {
    _codaEntity
    Cols {{typeName .Name "TableColumns"}}
}
{{- $columns := index $.Columns .ID }}
type {{typeName .Name "TableColumns"}} struct {
    {{- range $columns.Items }}
	{{ fieldName .Name }} _codaEntity /* {{ .Format.Type }} [{{ .Name }}]{{ if .Formula }} = {{ .Formula }}{{ end }} */
	{{- end}}
}

{{- end }}

//endregion

var ID = _schema{
    Table: _tableSchema{
        {{- range .Tables.Items }}
        {{- $columns := index $.Columns .ID }}
        {{ fieldName .Name }}: {{typeName .Name "Table"}}{
            _codaEntity: _codaEntity {
                   ID: `{{ .ID }}`,
                   Name: `{{ .Name }}`,
            },
            Cols: {{typeName .Name "TableColumns"}}{
                {{- range $columns.Items }}
                {{ fieldName .Name }}: _codaEntity {
                       ID:   `{{ .ID }}`,
                       Name: `{{ .Name }}`,
                },
                {{- end}}
            },
        },
        {{- end}}
    },
    Formula: _formulaSchema{
        {{- range .Formulas.Items }}
        {{ fieldName .Name }}: _codaEntity {
               ID:   `{{ .ID }}`,
               Name: `{{ .Name }}`,
           },
        {{- end }}
    },
    Control: _controlSchema{
        {{- range .Controls.Items }}
        {{ fieldName .Name }}: _codaEntity {
               ID:   `{{ .ID }}`,
               Name: `{{ .Name }}`,
           },
        {{- end }}
       },
}
